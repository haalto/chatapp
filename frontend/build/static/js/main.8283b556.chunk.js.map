{"version":3,"sources":["components/Users/Users.js","components/Chatboard/Chatboard.js","components/Login/Login.js","components/Sign/Sign.js","services/userServices.js","services/loginServices.js","components/App/App.js","index.js"],"names":["Users","users","className","map","user","key","_id","Chatboard","username","message","submitMessage","handleMessageChange","messages","messagesEndRef","useRef","useEffect","current","scrollIntoView","behavior","time","ref","onSubmit","onChange","value","type","Login","password","handleUsernameChange","handlePasswordChange","handleSubmit","handleShowSign","onClick","placeholder","Sign","handleShowLogin","baseUrl","newObject","axios","post","then","response","data","App","useState","setUser","token","setToken","loginUsername","setLoginUsername","loginPassword","setLoginPassword","signUsername","setSignUsername","signPassword","setSignPassword","setMessage","setMessages","activeUsers","setActiveUsers","showLogin","setShowLogin","showSign","setShowSign","showChat","setShowChat","socket","io","autoConnect","opts","query","open","on","concat","userData","console","log","handleShowLoginOrSign","event","preventDefault","loginServices","res","catch","err","target","userServices","returnedUser","emit","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.8283b556.chunk.js","sourcesContent":["import React from 'react'\r\n\r\nconst Users = ({ users }) => {\r\n  \r\n  const renderUsers = () => users.map(user => {  \r\n    if (user) {\r\n      return <p className=\"chat-user\" key={user._id}>{user}</p>\r\n    }    \r\n    return null\r\n  }) \r\n  \r\n  return (\r\n    <div className=\"container\">        \r\n      <div>{renderUsers()}</div>\r\n    </div>    \r\n  )\r\n}\r\n\r\nexport default Users\r\n","import React, { useRef, useEffect } from 'react'\r\nimport Users from '../Users/Users'\r\nimport './Chatboard.css'\r\n\r\nconst Chatboard = ({ username, message, submitMessage, handleMessageChange, users, messages }) => {\r\n  \r\n    const renderMessages = () => messages.map(message => {\r\n            \r\n      if (message) {\r\n        return (\r\n          <p \r\n            className=\"chat-message\" \r\n            key={message.time+message.user}\r\n          >\r\n            {/*message.time*/} \r\n            <strong>\r\n              {message.user}\r\n            </strong>\r\n            : {message.message}\r\n          </p>)\r\n      }\r\n      return null        \r\n    })\r\n\r\n    const messagesEndRef = useRef(null)\r\n\r\n    const scrollToBottom = () => {\r\n      messagesEndRef.current.scrollIntoView({ behavior: \"smooth\" })\r\n    }\r\n\r\n    useEffect(scrollToBottom, [messages]);\r\n  \r\n    return (      \r\n      <div className=\"chat\">           \r\n        <div className=\"chat-users\">   \r\n          <span className=\"chat-users-header\">users:</span>  \r\n            <Users          \r\n            users={users}\r\n            />\r\n        </div>      \r\n        <div className=\"chat-messages\">          \r\n          {renderMessages()}  \r\n          <div ref={messagesEndRef}></div>\r\n        </div>\r\n          <form onSubmit={submitMessage} className=\"chat-form\">                 \r\n            <strong>{username}:</strong>\r\n            <input\r\n              className=\"chat-input\" \r\n              onChange={handleMessageChange} \r\n              value={message}>                    \r\n            </input>\r\n            <button className=\"chat-button\" type=\"submit\">Send</button>              \r\n          </form>\r\n    </div>\r\n    )\r\n  }\r\n\r\n  export default Chatboard","import React from 'react'\r\nimport './Login.css'\r\n\r\nconst Login = ({ username, password, handleUsernameChange, handlePasswordChange, handleSubmit,handleShowSign }) => {\r\n    return (\r\n      <div className=\"login\">\r\n        <div className=\"login-header\">\r\n            <span className=\"login-header-main\">hello anonymous</span>\r\n            <span className=\"login-header-sub\">login or <span className=\"sign-up-link\" onClick={handleShowSign}>sign up</span></span>\r\n        </div>                                  \r\n        <form onSubmit={handleSubmit} className=\"login-form\">\r\n          <input \r\n            className=\"login-input\"\r\n            value={username} \r\n            onChange={handleUsernameChange}\r\n            placeholder=\"username\">                                  \r\n          </input>\r\n          <input \r\n            className=\"login-input\"  \r\n            type=\"password\"\r\n            placeholder=\"password\"\r\n            value={password}\r\n            onChange={handlePasswordChange}>          \r\n          </input>\r\n            <button \r\n              className=\"login-button\"\r\n              type=\"submit\">enter\r\n            </button >\r\n          </form>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Login","import React from 'react'\r\nimport './Sign.css'\r\n\r\nconst Sign = ({ username, password, handleUsernameChange, handlePasswordChange, handleSubmit,handleShowLogin }) => {\r\n    return (\r\n      <div className=\"sign\">\r\n        <div className=\"sign-header\">\r\n          <span className=\"sign-header-main\">new user</span>\r\n          <span className=\"sign-header-sub\">please sign up below or <span className=\"sign-up-link\" onClick={handleShowLogin}>login</span></span>\r\n        </div>                                \r\n        <form onSubmit={handleSubmit} className=\"sign-form\">\r\n          <input                         \r\n            className=\"sign-input\" \r\n            placeholder=\"username\"\r\n            value={username}\r\n            onChange={handleUsernameChange}>                                                        \r\n          </input>\r\n          <input \r\n            className=\"sign-input\"  \r\n            type=\"password\"\r\n            placeholder=\"password\"\r\n            value={password}\r\n            onChange={handlePasswordChange}>                              \r\n          </input>\r\n          <button \r\n            className=\"sign-button\"\r\n            type=\"submit\">enter\r\n          </button >\r\n        </form>\r\n      </div>\r\n    )\r\n}\r\n\r\nexport default Sign","import axios from 'axios'\r\n\r\nconst baseUrl = '/api/users'\r\n\r\nconst getAll = () => {\r\n    const request = axios.get(baseUrl)\r\n    return request.then(response => response.data)\r\n}\r\n\r\nconst getOne = id => {\r\n    const request = axios.get(`${baseUrl}/${id}`)\r\n    return request.then(response => response.data)\r\n}\r\n\r\nconst create = newObject => {\r\n    const request = axios.post(baseUrl, newObject)\r\n    return request.then(response => response.data)\r\n}\r\n\r\nconst update = (id, newObject) => {\r\n    const request = axios.put(`${baseUrl}/${id}`, newObject)\r\n    return request.then(response => response.data)\r\n}\r\n\r\nconst remove = id => {\r\n    const request = axios.delete(`${baseUrl}/${id}`)\r\n    return request.then(response => response.data)\r\n}\r\n\r\nexport default {\r\n    getAll,\r\n    getOne,\r\n    create,\r\n    update,\r\n    remove\r\n}","import axios from 'axios'\r\n\r\nconst baseUrl = '/login'\r\n\r\nconst login = (newObject) => {\r\n    const request = axios.post(baseUrl, newObject)\r\n    return request.then(response => response.data)\r\n}\r\n\r\nexport default {\r\n    login\r\n}","import React, { useState, useEffect, useRef } from 'react'\r\nimport './App.css'\r\nimport Chatboard from '../Chatboard/Chatboard'\r\nimport Login from '../Login/Login'\r\nimport Sign from '../Sign/Sign'\r\nimport io from 'socket.io-client'\r\nimport userServices from '../../services/userServices'\r\nimport loginServices from '../../services/loginServices'\r\n\r\nconst App = () => {   \r\n\r\n  //User state\r\n  const [ user, setUser ] = useState('')\r\n  const [ token, setToken ] = useState('')  \r\n  //Login state\r\n  const [ loginUsername, setLoginUsername] = useState('')\r\n  const [ loginPassword, setLoginPassword] = useState('')\r\n\r\n  //Sign up state\r\n  const [ signUsername, setSignUsername] = useState('')\r\n  const [ signPassword, setSignPassword] = useState('')\r\n\r\n  //New message\r\n  const [ message, setMessage ] = useState('')\r\n\r\n  //Other clients and messages\r\n  const [messages, setMessages] = useState([''])\r\n  const [ activeUsers, setActiveUsers] = useState([''])\r\n\r\n  //View state\r\n  const [ showLogin, setShowLogin] = useState(true)\r\n  const [ showSign, setShowSign ] = useState(false)\r\n  const [ showChat, setShowChat ] = useState(false)\r\n\r\n  const { current: socket } = useRef(io('/', {\r\n    autoConnect: false  \r\n  }))\r\n\r\n  //Effects*****************************************\r\n\r\n  //If user logged in succesfully connect socket to server\r\n  useEffect(() => {\r\n    \r\n    if (token) {\r\n      socket.io.opts.query = { token }   \r\n      socket.open()     \r\n      setShowLogin(false)\r\n      setShowChat(true)    \r\n    }\r\n  }, [token, socket])\r\n  \r\n  useEffect(() => {    \r\n\r\n    //receive messages\r\n    socket.on('chat-message', message => {\r\n      //console.log(`Received message: ${message.message} from ${message.user}`)\r\n      setMessages(messages => messages.concat(message))\r\n    })\r\n    \r\n    socket.on('active-users', userData => {\r\n      console.log('Active users', userData)\r\n      setActiveUsers(userData)\r\n    })\r\n\r\n  }, [socket]) \r\n\r\n  //Handlers************************************* \r\n\r\n  //Login handlers\r\n  const handleLoginUsernameChange = (event) => {\r\n    setLoginUsername(event.target.value)\r\n  }\r\n\r\n  const handleLoginPasswordChange = (event) => {\r\n    setLoginPassword(event.target.value)\r\n  }\r\n\r\n  const handleLoginSubmit = (event) => {\r\n    event.preventDefault()\r\n\r\n    const user = {\r\n      username: loginUsername,\r\n      password: loginPassword\r\n    }\r\n\r\n    loginServices.login(user)\r\n      .then(res => {\r\n        setLoginUsername('')\r\n        setLoginPassword('')\r\n        setUser(res.username)\r\n        setToken(res.token)  \r\n      })\r\n      .catch(err => {\r\n        console.log(err)\r\n      })\r\n  }\r\n\r\n  //Sign up handlers\r\n  const handleSignUsernameChange = (event) => {\r\n    setSignUsername(event.target.value)\r\n  }\r\n\r\n  const handleSignPasswordChange = (event) => {\r\n    setSignPassword(event.target.value)\r\n  }\r\n\r\n  const handleSignSubmit = (event) => {\r\n    event.preventDefault()\r\n\r\n    const user = {\r\n      username: signUsername,\r\n      password: signPassword\r\n    }\r\n\r\n    userServices.create(user)\r\n      .then(returnedUser => {\r\n        return loginServices.login(user) // if user was created succesfully, login user automatically\r\n      })\r\n      .then(res => {\r\n        console.log(res)\r\n        setUser(res.username)\r\n        setToken(res.token) \r\n        setSignUsername('')\r\n        setSignPassword('')\r\n        setShowSign(false)\r\n      })\r\n      .catch(err => console.log(err))    \r\n  }\r\n\r\n  //Message handlers\r\n  const handleMessageChange = (event) => {\r\n    setMessage(event.target.value) \r\n  }\r\n\r\n  const submitMessage = (event) => {\r\n    event.preventDefault()    \r\n    \r\n    if (message) {\r\n      console.log('Sending a new message')\r\n      socket.emit('new-message', {\r\n          message: message,\r\n          user: user\r\n      })\r\n      setMessage('')\r\n    }   \r\n  }\r\n\r\n  //View handlers\r\n  const handleShowLoginOrSign = () => {\r\n    setShowLogin(!showLogin)\r\n    setShowSign(!showSign)\r\n  }\r\n\r\n  return (\r\n    <div className=\"App\">\r\n      <div className=\"grid-container\">\r\n        <div></div>\r\n        {showLogin \r\n          ?\r\n          <div className=\"main\">\r\n            <Login\r\n              username={loginUsername}\r\n              password={loginPassword} \r\n              handleSubmit={handleLoginSubmit}\r\n              handleUsernameChange={handleLoginUsernameChange}\r\n              handlePasswordChange={handleLoginPasswordChange}\r\n              handleShowSign={handleShowLoginOrSign}\r\n            />\r\n          </div>\r\n          : ''\r\n        }\r\n        {showSign\r\n          ?\r\n            <div className=\"main\">\r\n              <Sign\r\n                handleShowLogin={handleShowLoginOrSign}\r\n                username={signUsername}\r\n                password={signPassword}\r\n                handleUsernameChange={handleSignUsernameChange}\r\n                handlePasswordChange={handleSignPasswordChange}\r\n                handleSubmit={handleSignSubmit}            \r\n            />\r\n          </div>\r\n          :''\r\n        }     \r\n        {showChat\r\n          ?\r\n            <div className=\"main\">\r\n              <Chatboard\r\n                username={user}\r\n                message={message}\r\n                submitMessage={submitMessage}\r\n                handleMessageChange={handleMessageChange}\r\n                messages={messages}\r\n                users={activeUsers}\r\n              />\r\n            </div>\r\n          : ''\r\n        }\r\n        <div></div>\r\n      </div>  \r\n    </div>    \r\n  )\r\n}\r\n\r\nexport default App\r\n","import React from 'react'\r\nimport ReactDOM from 'react-dom'\r\nimport App from './components/App/App'\r\n\r\nReactDOM.render(<App />, document.getElementById('root'))"],"sourceRoot":""}